#                           H5å…¨é¢åŸ‹ç‚¹ç»„ä»¶

## **å…¨åŸ‹ç‚¹ç»„ä»¶ç‰¹ç‚¹:**

1. ä¸å…¥ä¾µä¸šåŠ¡é¡¹ç›®ä»£ç (ä¸éœ€è¦åœ¨é¡µé¢ä¸­å†™ä»£ç ï¼Œåªéœ€è¦åœ¨main.jså¼•å…¥ï¼Œä¼ å‚æ•°é…ç½®å³å¯ä½¿ç”¨)
2. é€šè¿‡é…ç½®é‡‡é›†æ‰€æœ‰äº¤äº’äº¤äº’è¡Œä¸º(é‡‡é›†æ•°æ®ç±»å‹å¦‚ä¸‹)
3. é¡µé¢æ€§èƒ½(é¡µé¢æ‰€æœ‰èµ„æºåŠ è½½æ€§èƒ½ï¼Œé¡µé¢æ¸²æŸ“æ€§èƒ½)æ•°æ®åˆ†æä¸é‡‡é›†(é‡‡é›†æ•°æ®ç±»å‹å¦‚ä¸‹)
4. é‡‡é›†çš„æ•°æ®ä¸Šä¼ (ä¼ å…¥å…¬å¸æœåŠ¡å™¨è¯·æ±‚é…ç½®å³å¯è¿›è¡Œæ•°æ®ç»Ÿä¸€ä¸Šä¼ ,ä¹Ÿå¯æ“ä½œå­˜å‚¨çš„é‡‡é›†æ•°æ®è‡ªå®šä¹‰ä¸Šä¼ )
5. å¯æ­é…ä¸šåŠ¡é¡¹ç›®ä¹‹å‰çš„ä»£ç åŸ‹ç‚¹é‡‡é›†è°ƒç”¨ç»„ä»¶tackæ–¹æ³•å­˜å‚¨æ•°æ®ä¸å…¨åŸ‹ç‚¹ç»„ä»¶æ•°æ®è¿›è¡Œå…±åŒå­˜å‚¨

ç›®å‰å…¼å®¹æ¡†æ¶æœ‰ uniapp vue2.0  vue3.0 reactï¼›
å¾®ä¿¡å°ç¨‹åºæ¡†æ¶ç›®å‰æœªåšå…¼å®¹ï¼Œ é˜¿å‹‡æ­£åœ¨ç©å‘½å¼€å‘...

æ›´æ–°æ—¥å¿—å…¬å‘ŠğŸª§ä»¥ å¾®ä¿¡å…¬ä¼—å·ä¸ºä¸» âš ï¸âš ï¸âš ï¸ï¼ï¼ï¼ **(å…³æ³¨å…¬ä¼—å·) => é˜¿å‹‡å­¦å‰ç«¯**

## åŸ‹ç‚¹ç»„ä»¶é‡‡é›†æ•°æ®å­—æ®µä»‹ç»ã€é‡‡é›†æ•°æ®åˆ†ä¸‰ç±»

1. #### äº¤äº’æ•°æ®:  ç‚¹å‡»æ–‡æ¡ˆ ä¸ç»‘å®šçš„ä¸šåŠ¡æ•°æ®

2. #### é¡µé¢æ•°æ®&&æ€§èƒ½æ•°æ® :é¡µé¢åœç•™æ—¶é—´ ä¸é¡µé¢èµ„æºåŠ è½½æ€§èƒ½æ—¶é—´åˆ†æ

3. #### é€šç”¨æ•°æ®:åŒ…å« é¡¹ç›®ä¿¡æ¯ è®¾å¤‡ç¡¬ä»¶ä¿¡æ¯ã€‚äº¤äº’æ•°æ®ä¸é¡µé¢æ•°æ®

#### ç”¨æˆ·äº¤äº’ä¿¡æ¯ä»‹ç»

| å­—æ®µä»‹ç»     | ç±»å‹   | è¯´æ˜                                                      |
| ------------ | ------ | --------------------------------------------------------- |
| id           | string | æ•°æ®å”¯ä¸€id                                                |
| actionType   | string | é‡‡é›†ç±»å‹ è§ä¸‹æ–¹è¯¦æƒ…                                       |
| elementText  | string | ç”¨æˆ·äº¤äº’èŠ‚ç‚¹æ–‡æ¡ˆ(actionType=clickæ—¶æ‰æœ‰)                  |
| ....ä¸šåŠ¡æ•°æ® | string | æ’å…¥å½“å‰æ–‡æ¡ˆæ‰€ç»‘å®šçš„ä¸šåŠ¡æ•°æ®,ä½¿ç”¨æ–¹å¼è§ ç»„ä»¶init æ–¹æ³•è°ƒç”¨ |

#### é¡µé¢é‡‡é›†æ•°æ®

| å­—æ®µä»‹ç»        | ç±»å‹         | è¯´æ˜                                   |
| --------------- | ------------ | -------------------------------------- |
| actionType      | string       | é‡‡é›†ç±»å‹ è§ä¸‹æ–¹è¯¦æƒ…                    |
| DNS             | number       | nscæ—¶é•¿                                |
| DOM             | number       | domæ¸²æŸ“æ—¶é•¿                            |
| Load            | number       | é¡µé¢åŠ è½½æ—¶é•¿                           |
| TCP             | number       | tcpè¯·æ±‚æ—¶é•¿                            |
| WhitecrSeend    | number       | ç™½å±æ—¶é•¿                               |
| allResourceLoad | Indicators[] | é¡¹ç›®æ‰€ä»¥èµ„æºåŠ è½½(å›¾ç‰‡,JS,link,CSS)æ—¶é—´ |
| entetTim        | number       | é¡µé¢è¿›å…¥æ—¶é—´æˆ³                         |
| leaveTime       | number       | é¡µé¢ç¦»å¼€æ—¶é—´æˆ³                         |
| remainTime      | number       | é¡µé¢åœç•™æ—¶é—´                           |
| oldURL          | string       | è·³è½¬å‰çš„é¡µé¢                           |



#### é€šç”¨ä¿¡æ¯ä»‹ç»

| å­—æ®µä»‹ç»    | ç±»å‹     | è¯´æ˜                                                         |
| ----------- | -------- | ------------------------------------------------------------ |
| pageUrl     | string   | å½“å‰é¡µé¢è·¯å¾„                                                 |
| projectName | string   | é¡¹ç›®åç§°                                                     |
| userInfo    | userInfo | ä¸€èˆ¬ä¿¡æ¯                                                     |
| availHeight | string   | å±å¹•é«˜åº¦                                                     |
| availWidth  | string   | å±å¹•å®½åº¦                                                     |
| resolution  | string   | å±å¹•åƒç´                                                      |
| systemType  | string   | ç³»ç»Ÿç±»å‹                                                     |
| phoneBrand  | string   | æ‰‹æœºå“ç‰Œ                                                     |
| phoneVision | string   | æ‰‹æœºç³»ç»Ÿç‰ˆæœ¬                                                 |
| position    | string   | å®šä½ä¿¡æ¯ ï¼ˆå®šä½å¤±è´¥æ—¶å€™æ˜¯ æŠ¥é”™ä¿¡æ¯ï¼‰<br/> é»˜è®¤ä¸è·å–å®šä½ä¿¡æ¯,<br/>è·å–å®šä½éœ€è¦åœ¨ç»„ä»¶ä½¿ç”¨æ—¶ä¼ å…¥å‚æ•°é…ç½®è¯¦æƒ…è§ä½¿ç”¨æ–¹å¼ |

#### é‡‡é›†ç±»å‹actionTypeå­—æ®µä»‹ç»

| å­—æ®µä»‹ç» | ç±»å‹   | è¯´æ˜     |
| -------- | ------ | -------- |
| click    | string | ç”¨æˆ·ç‚¹å‡» |
| pageLoad | string | é¡µé¢åŠ è½½ |
| pagejump | string | é¡µé¢è·³è½¬ |
| pageBack | string | é¡µé¢è¿”å› |

**å½“å‰é¡µé¢é¦–æ¬¡æ‰€æœ‰èµ„æºåŠ è½½æ€§èƒ½allResourceLoadå­—æ®µä»‹ç»**

| å­—æ®µä»‹ç» | ç±»å‹   | è¯´æ˜         |
| -------- | ------ | ------------ |
| name     | string | èµ„æºåŠ è½½åœ°å€ |
| duration | number | é¡µé¢åŠ è½½     |

**ä½¿ç”¨æ–¹å¼ 1ä¸‹è½½ 2å¼•å…¥ 3è°ƒç»„ä»¶init()æ–¹æ³•ä¼ å…¥å‚æ•°å³å¯ä½¿ç”¨**

## ä¸€ : ä¸‹è½½

åœ¨é¡¹ç›®æ²¡æœ‰package.jsonæƒ…å†µä¸‹éœ€è¦
```javascript
npm init -y
```

```javascript
npm install monito-action
// æˆ–
//yarn add monito-action
```

## äºŒ :æ–°å»ºjsæ–‡ä»¶å¼•å…¥ç»„ä»¶ä½¿ç”¨å¹¶å¯¼å‡ºå®ä¾‹å¯¹è±¡(vue3.0ç¤ºä¾‹)

<span id="init">initæ–¹æ³•è°ƒç”¨ç¤ºä¾‹</span>
æ–°å»ºJ Sæ–‡ä»¶å¹¶å¯¼å‡ºå®ä¾‹å¯¹è±¡åŸå›  æ˜¯å› ä¸º,åœ¨Vue3ä¸­æ²¡æœ‰this, å®ä¾‹å¯¹è±¡ä¸­çš„tackæ–¹æ³•å¿…é¡»é€šç”¨è¿‡å¼•å…¥JSæ–‡ä»¶è°ƒç”¨

    å¦‚æœæ˜¯vue2é¡¹ç›®å¯ç›´æ¥åœ¨main.jså¼•å…¥ ,é€šè¿‡æŒ‚è½½å…¨å±€å¯¹è±¡,åœ¨é¡µé¢ä¸­ä½¿ç”¨thisè¿›è¡Œè°ƒç”¨
```javascript

Vue.prototype.$monitoAction = monitoAction;
```
```js

import MonitoAction from 'monito-action';
export const monitoAction = new MonitoAction();

monitoAction.init({
    frameType:'vue',
    reques:{
        requestUrl:'http://www.liulongbin.top:3006/api/post',
        requerequesKeysHeader:{},
        requesKey:'value',
        maxRequesGatewayLength:3,
    },
    showLog: true,
    monitoSwitch: true,
    isPosition: true,
    userInfo:{
        userCode:'1540018883'
    },
    projectName: 'å…¨åŸ‹ç‚¹ç»„ä»¶',
    globaMonitoConfigList: [{
        elementText: 'Hello',
        elementEevent: '',
    },{
        elementText: 'add',
        elementEevent: '',
    }, ],
    globaMonitoImgList:[
        {imgSrc:'ayong.jpeg',businessData:'1å·å¹¿å‘Šä½ç½®'}
    ]
})
export default monitoAction
```
### åœ¨ main.jsè¯¥jsæ–‡ä»¶(vue3.0ç¤ºä¾‹)
```js
import {createApp} from 'vue';
import App from './App.vue';
import './action'
const app = createApp(App);
app.use(router).use(ElementPlus).use(store).mount('#app');

```
### ä¸‰:tackæ–¹æ³•æ–¹æ³•ä»‹ç» ä¸»è¦ç”¨äºJSæ–¹æ³•é‡‡é›†æ•°æ®ã€ä»£ç åŸ‹ç‚¹è°ƒç”¨ç»„ä»¶å®ä¾‹æ–¹æ³•è¿›è¡Œæ•°æ®å­˜å‚¨ï¼Œæ–¹æ³•å¦‚å‚æ•°éšæ„æ­é…
```template
<<template>>
  <div @click="monitoAction.track({actionType:(+ new Date()).toString()})">tack</div>
</template>
```

```vue3
<script lang="ts" setup>
import monitoAction from '../../action'
</script>
```

### å››:initå…¥å‚æ–¹æ³•ä»‹ç»

| å­—æ®µå                | ç±»å‹            | æ˜¯å¦å¿…ä¼  | ä»‹ç»                                                |
| --------------------- |---------------| -------- |---------------------------------------------------|
| frameType             | FrameType     | å¿…ä¼      | é¡¹ç›®æ¡†æ¶ç±»å‹;è§ä¸‹æ–¹è¯¦æƒ… [FrameTypeä»‹ç» ](#FrameType)           |
| globaMonitoConfigList | MonitoList[ ] | å¿…ä¼      | åŸ‹ç‚¹é‡‡é›†é…ç½®åˆ—è¡¨;è§ä¸‹æ–¹è¯¦æƒ…  [MonitoListä»‹ç» ](#MonitoList)      |
| userInfo              | UserInfo      | å¿…ä¼      | ä¸€èˆ¬ä¿¡æ¯;è§ä¸‹æ–¹è¯¦æƒ…[userInfoä»‹ç» ](#userInfo)                |
| projectName           | string        | å¿…ä¼      | é¡¹ç›®åç§°                                              |
| reques                | Reques        | éå¿…ä¼    | ä¸ŠæŠ¥æ•°æ®å…¥å‚  [requesä»‹ç» ](#reques)                      |
| monitoSwitch          | Boolean       | éå¿…ä¼    | æ˜¯å¦å¼€å¯åŸ‹ç‚¹ é»˜è®¤å¼€å¯ true                                  |
| showLog               | Boolean       | éå¿…ä¼    | æ˜¯å¦æ‰“å°æ—¥å¿— é»˜è®¤falseä¸æ‰“å°                                 |
| isPosition            | Boolean       | éå¿…ä¼    | æ˜¯å¦è·å–å®šä½ä¿¡æ¯ é»˜è®¤ä¸è·å– fasle<br/>(è·å–å®šä½ç”¨æˆ·é¡µé¢ä¼šæ”¶åˆ°æ˜¯å¦è·å–å®šä½çš„ç³»ç»Ÿå¼¹æ¡†) |
| globaMonitoImgList            | ImgList[]     | éå¿…ä¼    | é¡¹ç›®å›¾ç‰‡äº¤äº’æ•°æ®é‡‡é›† æ•°æ®æ ¼å¼è¯¦æƒ…[ImgListä»‹ç» ](#ImgList)                                  |

#### <span id="FrameType">FrameTypeæ¡†æ¶ç±»å‹å­—æ®µä»‹ç» </span>

| å€¼       | ç±»å‹   | ä»‹ç»                                      |
| -------- | ------ | ----------------------------------------- |
| 'vue'    | string | Vue2  vue3 æ¡†æ¶å…¼å®¹                       |
| 'react', | string | react æ¡†æ¶å…¼å®¹                            |
| 'uniapp' | string | Uniapp ç¼–è¯‘H5å…¼å®¹ âš ï¸ä¸åŒ…æ‹¬uniappç¼–è¯‘å°ç¨‹åº |
| 'wx',    | string | 1.0.0å½“å‰ç‰ˆæœ¬æš‚ä¸æ”¯æŒwxæ¡†æ¶               |

#### <span id="MonitoList">MonitoListåŸ‹ç‚¹é‡‡é›†é…ç½®åˆ—è¡¨å­—æ®µä»‹ç»</span>

| å€¼          | ç±»å‹   | ä»‹ç»                        |
| ----------- | ------ |---------------------------|
| elementText | string | éœ€è¦é‡‡é›†çš„domèŠ‚ç‚¹æ–‡æ¡ˆ              |
| ...         | any    | è¯¥domèŠ‚ç‚¹çš„å…¶ä»–ä¸šåŠ¡æ•°æ®ï¼›å­—æ®µåç›´æ¥å¢åŠ å³å¯ ç¤ºä¾‹å¦‚ä¸‹ |

```js
const globaMonitoConfigList: [{
        elementText: 'ç™»é™†',
        businessData: 'è¿™æ˜¯ç™»é™†æŒ‰é’®çš„ä¸šåŠ¡æ•°æ®',
    },{
        elementText: 'æŸ¥çœ‹ä¿¡æ¯',
        businessData: 'è¿™æ˜¯æŸ¥çœ‹ä¿¡æ¯æŒ‰é’®çš„ä¸šåŠ¡æ•°æ®',
    }, ]

monitoAction.init({
    ...
        globaMonitoConfigList,
    ....
})
```
#### <span id="ImgList">ImgListå›¾ç‰‡åŸ‹ç‚¹é‡‡é›†é…ç½®åˆ—è¡¨å­—æ®µä»‹ç»</span>

| å€¼          | ç±»å‹   | ä»‹ç»                        |
| ----------- | ------ |---------------------------|
| imgSrc | string | éœ€è¦é‡‡é›†çš„å›¾ç‰‡æ–‡ä»¶åï¼ˆåŒ…å«æ–‡ä»¶åç¼€ï¼‰        |
| ...         | any    | è¯¥å›¾ç‰‡çš„å…¶ä»–ä¸šåŠ¡æ•°æ®ï¼›å­—æ®µåç›´æ¥å¢åŠ å³å¯ ç¤ºä¾‹å¦‚ä¸‹ |

```js
const globaMonitoConfigList: [{
        imgSrc: 'star.jpeg',
        businessData: 'è¿™æ˜¯æ˜Ÿæ˜Ÿå›¾ç‰‡ä¸šåŠ¡æ•°æ®',
    },{
    imgSrc: 'pasword.png',
        businessData: 'è¿™æ˜¯éªŒè¯ç å›¾ç‰‡ä¸šåŠ¡æ•°æ®',
    }, ]

monitoAction.init({
    ...
        globaMonitoConfigList,
    ....
})
```
#### <span id="userInfo">userInfoåŸ‹ç‚¹é‡‡é›†é…ç½®åˆ—è¡¨å­—æ®µä»‹ç»</span>

| å€¼      | ç±»å‹   | ä»‹ç»                                               |
| ------- | ------ | -------------------------------------------------- |
| useCode | string | å”¯ä¸€å­—ç¬¦ (ä¸»è¦ç”¨äºé‡‡é›†æ•°æ®æœ¬åœ°å­˜å‚¨æ—¶ æ•°æ®åº“åå”¯ä¸€) |

#### requesåŸ‹ç‚¹é‡‡é›†é…ç½®åˆ—è¡¨å­—æ®µä»‹ç»

| å€¼                     | ç±»å‹   | ä»‹ç»                                                         |
| ---------------------- | ------ | ------------------------------------------------------------ |
| requestUrl             | string | ä¸ŠæŠ¥æ•°æ®åœ°å€,ä¸é…ç½®ç»„ä»¶åªé‡‡é›†æ•°æ®å¹¶å­˜å‚¨å°†ä¸ä¼šä¸Šä¼ ,<br/>éœ€è¦å¼€å‘äººå‘˜è‡ªå®šä¹‰ä¸Šä¼ ;è‡ªå®šä¹‰ä¸Šä¼ æ•°æ®éœ€è¦[æ“ä½œé‡‡é›†æ•°æ®æ–¹å¼è§ä¸‹æ–¹è¯¦æƒ… ](#getAllData) |
| requesHeader           | Object | ä¸Šä¼ è¯·æ±‚å¤´:ä¾‹å¦‚token,åç«¯èº«ä»½éªŒè¯å‚æ•° [ä½¿ç”¨ç¤ºä¾‹ ](#init)     |
| requesKey              | string | ä¸Šä¼ æ•°æ®æ—¶ä¸å…¬å¸æœåŠ¡å™¨åç«¯æ¥æ”¶å­—æ®µ,é»˜è®¤å€¼ : value ä¾‹å¦‚ {[requesKey]:é‡‡é›†æ•°æ®}  [ä½¿ç”¨ç¤ºä¾‹ ](#init) |
| maxRequesGatewayLength | Number | æœ€å¤§å­˜å‚¨é‡(å•ä½/æ¡)ä¸Šä¼ ;é»˜è®¤10,ä¾‹å¦‚é‡‡é›†10æ¡æ•°æ®åå°†è¿›è¡Œä¸Šä¼ ,è®¾ç½®ä¸º1æ—¶å°†å®æ—¶ä¸Šä¼ ,åœ¨ä¸ä¼ requestUrlå­—æ®µæ—¶éœ€è¦å®æ—¶è·å–é‡‡é›†æ•°æ®,è¿›è¡Œè‡ªå®šä¹‰ä¸Šä¼ æ•°æ® [æ“ä½œé‡‡é›†æ•°æ®æ–¹å¼è§ä¸‹æ–¹è¯¦æƒ… ](#getAllData) |



#### <span id="getalldata">**æ“ä½œä¸Šä¼ æ•°æ®ä»£ç ç¤ºä¾‹**</span>

##### éœ€è¦ç›‘å¬ç»„ä»¶å‘å‡ºçš„è®¢é˜…äº‹ä»¶ monito

```
window.addEventListener('monito', async res => {
	const allData = await res.detail.getAllData();//è·å–æ‰€æœ‰æ•°æ®
	const countData = await res.detail.getCountData();//è·å–æ•°æ®é‡æ¡æ•°
/****
*  è‡ªå®šä¹‰ä¸Šä¼ æ•°æ®ç½‘ç»œè¯·æ±‚
**/
	const clearData = await res.detail.clearData(); //åˆ é™¤æ‰€æœ‰æ•°æ®
});
```

## è¯¥ç»„ä»¶å¼€å‘æºç æ”¾ç½® GitHbu ä»“åº“(æœ‰éœ€è¦å‚ä¸è´¡çŒ®ä¸å¼€å‘å¯ä»¥è‡ªè¡Œæ‹‰å»ä»£ç å¼€å‘æäº¤)ä¸è¦å¿˜äº†ç»™é˜¿å‹‡ç‚¹é¢—æ˜Ÿæ˜Ÿå“Ÿ

https://github.com/AyongNice/gather-action
